<!-- Getting ractive from CDN -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/ractive/0.7.3/ractive-legacy.js'></script>

<!--If CND Fails It Loads from Local Server   -->
<script>
if (typeof ractive == 'undefined') {
    document.write(unescape("%3Cscript src='js/ractive.js' type='text/javascript'%3E%3C/script%3E"));
}
</script>

<!--Loading External CSS  -->
<link rel="stylesheet" type="text/css" href="css/main.css">

<!--Main Content  -->
<h1 style="padding-top:100px; color:royalblue;">Multiple Progress Bars</h1>

<div id='container'> </div>

<!--End of Main Content  -->

<!--Progress  Template  -->
<script id="template" type='text/ractive'>
    {{#each progressbars}}
         <br>
	{{#if value < 1 }}
            <div class="progress-bar-fill" style="width:{{0*value}}%">
				 <div class="progress-bar">
				 </div>
                <span class="progress-label">0%</span>
            </div>
	{{ }}

        {{/if}}	

        {{#if value < 100 && value > 1}}
            <div class="progress-bar-fill" style="width: {{3*value/4}}%">
				<div class="progress-bar">
				 </div>
                <span class="progress-label">{{Math.floor(value)}}%</span>
            </div>
        {{/if}}

        {{#if value>=100}}
            <div class="progress-bar-fill-red" style="width: 75%">
			<div class="progress-bar">
			 </div>
                <span class="progress-label">{{Math.floor(value)}}%</span>
            </div>
        {{/if}}
    {{/each}}
	<div id="actionDiv">
    <select class="select-input" value='{{selectedProgress}}'>
        <option selected disabled>Select ProgressBar</option>
        {{#each progressbars :index}}
            <option value='{{index}}'>{{name}}</option>
        {{/each}}
    </select>

    {{#each amounts}}
        <button disabled='{{selectedProgress == null}}' on-click='adjust(this)'>{{this > 0 ? '+' : ''}}{{this}}</button>
    {{/each}}
	</div>
</script>
<!--End of Progress  Template  -->

<!-- Ractive Script -->
<script>
var  progressbars = [];
var ractive = new Ractive({
    el: "#container", //Target for output to display 
    template: '#template',//Data to display in output
    data: {
        progressbars: [
            { name: 'ProgressOne', value:20 },
            { name: 'ProgressTwo', value: 35 },
            { name: 'ProgressThree', value: 15 }
        ],
        amounts: [ +25, +10, -10, -25 ]
    },
    //This function picks the progress bar dynamically
    adjust: function ( d ) {
        var selected = this.get( 'selectedProgress' );
        if ( selected == null ) return;
        var keypath ='progressbars[' + selected + '].value';
        var keypath_value=this.get(String(keypath));;
	if(keypath_value < 0) {
		keypath_value=0;
	}
	//Animates the change
	ractive.animate(keypath,keypath_value+d);
    } 
});
</script>
